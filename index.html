<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIIMS Protocol App</title>
    
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#121212">
    
    <link rel="manifest" href="data:application/manifest+json;base64,ewogICJuYW1lIjogIkFJSU1TIFByb3RvY29sIiwKICAic2hvcnRfbmFtZSI6ICJQcm90b2NvbCIsCiAgInN0YXJ0X3VybCI6ICIuIiwKICAiZGlzcGxheSI6ICJzdGFuZGFsb25lIiwKICAiYmFja2dyb3VuZF9jb2xvciI6ICIjMTIxMjEyIiwKICAidGhlbWVfY29xvciI6ICIjZWY0NDQ0IiwKICAiaWNvbnMiOiBbXQp9">

    <style>
        /* --- DYNAMIC THEME VARIABLES --- */
        :root {
            --bg-body: #121212;
            --bg-card: #1e1e1e;
            --text-main: #ffffff;
            --text-sub: #888888;
            --accent: #ef4444; /* Red */
            --border: #333;
            --status-bg: rgba(239, 68, 68, 0.2);
        }

        /* --- THEME: WORK (DARK + RED) --- */
        body.mode-work {
            --bg-body: #0a0a0a;       
            --bg-card: #171717;       
            --text-main: #f5f5f5;     
            --text-sub: #a1a1aa;      
            --accent: #ff2a2a;        /* Neon Red */
            --border: #333333;
            --status-bg: rgba(220, 38, 38, 0.3);
        }

        /* --- THEME: BREAK (WHITE + GREEN) --- */
        body.mode-break {
            --bg-body: #f0fdf4;       /* Mint White */
            --bg-card: #ffffff;       
            --text-main: #14532d;     /* Dark Green Text */
            --text-sub: #4ade80;      
            --accent: #16a34a;        /* Strong Green */
            --border: #bbf7d0;
            --status-bg: #dcfce7;
        }

        /* --- LAYOUT OPTIMIZED FOR 1400x900 --- */
        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: background-color 0.8s ease, color 0.8s ease;
            user-select: none; /* App-like feel */
        }

        header {
            padding: 15px 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 80px;
            border-bottom: 2px solid var(--border);
            transition: border-color 0.8s ease;
            flex-shrink: 0;
        }

        .header-left h1 {
            font-size: 1.5rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin: 0;
            color: var(--accent);
        }

        #clock {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-main);
            font-variant-numeric: tabular-nums;
        }

        /* --- LIST CONTAINER --- */
        .container {
            flex-grow: 1;
            overflow-y: auto;
            padding: 40px 0;
            scroll-behavior: smooth;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container::-webkit-scrollbar { width: 0; }

        .row {
            display: flex;
            align-items: center;
            width: 70%; 
            max-width: 1000px; 
            margin-bottom: 12px;
            background: var(--bg-card);
            padding: 18px 30px;
            border-radius: 10px;
            border-left: 5px solid transparent;
            opacity: 0.5;
            transition: all 0.5s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .time {
            width: 160px; /* Wider for 12h format */
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-sub);
        }

        .task {
            flex-grow: 1;
            font-size: 1.3rem;
            font-weight: 500;
        }

        .status {
            font-size: 0.9rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-sub);
            min-width: 140px;
            text-align: right;
        }

        /* --- ACTIVE STATE --- */
        .row.active {
            opacity: 1;
            border-left: 8px solid var(--accent);
            background: var(--bg-card);
            transform: scale(1.03);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
            z-index: 10;
        }

        .row.active .time, 
        .row.active .task {
            color: var(--accent);
            font-weight: 700;
        }

        .row.active .status {
            background: var(--status-bg);
            color: var(--accent);
            padding: 8px 15px;
            border-radius: 6px;
        }

        /* Urgent Animation */
        body.mode-work .row.active .status {
            animation: breathe 2s infinite;
        }
        @keyframes breathe {
            0% { opacity: 1; box-shadow: 0 0 5px var(--accent); }
            50% { opacity: 0.7; box-shadow: 0 0 15px var(--accent); }
            100% { opacity: 1; box-shadow: 0 0 5px var(--accent); }
        }

        /* --- PAST STATE --- */
        .row.past {
            opacity: 0.2;
            filter: grayscale(100%);
        }
        
        /* Break Mode Specifics */
        body.mode-break .row.active {
            border-color: #16a34a; 
        }

    </style>
</head>
<body class="mode-work">

    <header>
        <div class="header-left">
            <h1 id="mode-title">FOCUS APP</h1>
        </div>
        <div class="header-right">
            <div id="clock">12:00 PM</div>
        </div>
    </header>

    <div class="container" id="schedule-list">
        </div>

    <script>
        // --- 45/15 PROTOCOL (Internal Logic uses 24h for math, Display uses 12h) ---
        const schedule = [
            { start: "08:00", end: "08:45", task: "Biology Lecture", type: "work" },
            { start: "08:45", end: "09:00", task: "Break (Refill Water)", type: "break" },
            
            { start: "09:00", end: "09:45", task: "Biology Lecture", type: "work" },
            { start: "09:45", end: "10:00", task: "Break", type: "break" },

            { start: "10:00", end: "10:45", task: "Biology Lecture", type: "work" },
            { start: "10:45", end: "11:00", task: "Break", type: "break" },

            { start: "11:00", end: "11:45", task: "Biology Revision", type: "work" },
            { start: "11:45", end: "12:00", task: "Break", type: "break" },

            { start: "12:00", end: "12:45", task: "Biology Q Practice (90Q)", type: "work" },
            { start: "12:45", end: "13:00", task: "Break", type: "break" },

            { start: "13:00", end: "13:45", task: "Free / Meal / Rest", type: "break" },
            { start: "13:45", end: "14:00", task: "Break", type: "break" },

            { start: "14:00", end: "14:45", task: "Chemistry Lecture", type: "work" },
            { start: "14:45", end: "15:00", task: "Break", type: "break" },

            { start: "15:00", end: "15:45", task: "Chemistry Revision", type: "work" },
            { start: "15:45", end: "16:00", task: "Break", type: "break" },

            { start: "16:00", end: "16:45", task: "Chemistry Q Practice", type: "work" },
            { start: "16:45", end: "17:00", task: "Break", type: "break" },

            { start: "17:00", end: "17:45", task: "Chemistry Q Practice", type: "work" },
            { start: "17:45", end: "18:00", task: "Break", type: "break" },

            { start: "18:00", end: "18:45", task: "Free / Reset", type: "break" },
            { start: "18:45", end: "19:00", task: "Break", type: "break" },

            { start: "19:00", end: "19:45", task: "Physics Lecture", type: "work" },
            { start: "19:45", end: "20:00", task: "Break", type: "break" },

            { start: "20:00", end: "20:45", task: "Free / Light Work", type: "break" },
            { start: "20:45", end: "21:00", task: "Break", type: "break" },

            { start: "21:00", end: "21:45", task: "Physics Q Practice", type: "work" },
            { start: "21:45", end: "22:00", task: "Break", type: "break" },

            { start: "22:00", end: "22:45", task: "Physics Notes", type: "work" },
            { start: "22:45", end: "23:00", task: "Break", type: "break" },

            { start: "23:00", end: "23:45", task: "Physics Q Practice", type: "work" },
            { start: "23:45", end: "23:59", task: "Sleep Prep", type: "break" }
        ];

        // --- HELPER: 24H to 12H ---
        function format12(time24) {
            let [h, m] = time24.split(':').map(Number);
            const ampm = h >= 12 ? 'PM' : 'AM';
            h = h % 12;
            h = h ? h : 12; // 0 becomes 12
            const mStr = m < 10 ? '0' + m : m;
            return `${h}:${mStr} ${ampm}`;
        }

        function getMinutes(timeStr) {
            const [h, m] = timeStr.split(':').map(Number);
            return h * 60 + m;
        }

        function init() {
            const container = document.getElementById('schedule-list');
            schedule.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'row';
                div.id = `slot-${index}`;
                // Display using 12h format
                div.innerHTML = `
                    <div class="time">${format12(item.start)}</div>
                    <div class="task">${item.task}</div>
                    <div class="status" id="status-${index}">WAITING</div>
                `;
                container.appendChild(div);
            });
            update();
            setInterval(update, 1000);
        }

        function update() {
            const now = new Date();
            // Main Clock 12h
            document.getElementById('clock').innerText = now.toLocaleTimeString('en-US', { hour12: true });

            const currentTotalMin = now.getHours() * 60 + now.getMinutes();
            let anyActive = false;

            schedule.forEach((item, index) => {
                const row = document.getElementById(`slot-${index}`);
                const statusTxt = document.getElementById(`status-${index}`);
                
                const startMin = getMinutes(item.start);
                const endMin = getMinutes(item.end);

                row.classList.remove('active', 'past');

                if (currentTotalMin >= startMin && currentTotalMin < endMin) {
                    // --- ACTIVE SLOT ---
                    anyActive = true;
                    row.classList.add('active');

                    // 1. CHANGE THEME
                    if (item.type === 'work') {
                        document.body.className = 'mode-work';
                        document.getElementById('mode-title').innerText = "ðŸ”¥ FOCUS MODE";
                    } else {
                        document.body.className = 'mode-break';
                        document.getElementById('mode-title').innerText = "ðŸŒ¿ RECOVERY";
                    }

                    // 2. COUNTDOWN
                    const endTime = new Date();
                    endTime.setHours(Math.floor(endMin / 60));
                    endTime.setMinutes(endMin % 60);
                    endTime.setSeconds(0);
                    const diff = endTime - now;
                    
                    if (diff > 0) {
                        const m = Math.floor((diff / 1000 / 60) % 60);
                        const s = Math.floor((diff / 1000) % 60);
                        statusTxt.innerText = `${m}m ${s}s`;
                    } else {
                        statusTxt.innerText = "0m 0s";
                    }

                    // 3. AUTO SCROLL
                    if (!window.isScrolling) {
                        row.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }

                } else if (currentTotalMin >= endMin) {
                    row.classList.add('past');
                    statusTxt.innerText = "DONE";
                } else {
                    statusTxt.innerText = "UPCOMING";
                }
            });
            
            // Idle State
            if (!anyActive) {
                document.body.className = 'mode-break';
                document.getElementById('mode-title').innerText = "SYSTEM IDLE";
            }
        }

        // Handle Scroll Interaction
        window.isScrolling = false;
        let scrollTimer;
        window.addEventListener('scroll', () => {
            window.isScrolling = true;
            clearTimeout(scrollTimer);
            scrollTimer = setTimeout(() => window.isScrolling = false, 5000);
        }, true);

        init();
    </script>
</body>
</html>
